---
layout: post
title: "google c++ style guide"
date: 2014-07-19 11:12:37 +0900
comments: true
tags: [coding convention, c++] 
---

지금 참여중인 프로젝트에서 얼마전에 코딩 컨벤션을 통일하는 작업이 있었습니다. 
본격적으로 컨벤션을 통일하고 이제 한 서너달? 정도 지난 것 같네요. 

처음에는 팀원 대다수가 많이 혼란스러워 했지만 이제 어느 정도 시간이 지나고 나니 팀 내 프로그래머 모두가 거의 유사한 스타일의 코드를 작성하게 됐습니다. 이렇게 되니 전보다 코드 가독성이 좋아지고 협업을 할 때 이런 저런 많은 도움이 됩니다. 

<!-- more -->

사실 컨벤션이 통일되면 좋다는 것은 아주 상식적인 말입니다만, 개개인이 선호하는 스타일이 다 다르기 때문에 통일을 하기가 쉽지 않다는 것이 문제입니다. 팀에서도 그동안 몇 차례 시도 했었지만 잘 안되었다가, 이번에서야 겨우 성공했어요. 

이번에 컨벤션의 통일을 성공한 주된 요인 중의 하나는 구글 내부에서 사용하는 컨벤션을 정리해서 공개한 [구글 C++ 스타일 가이드](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml)라고 볼 수 있습니다. 이 문서의 내용을 가져와 몇 가지 사항만 프로젝트에 맞게 조정하여 적용 하였지요. 구글 컨벤션의 코드들은 처음 볼 땐 좀 낮설었지만 적응하고 나니 이젠 괜찮군요. 

팀에 도입하는 과정에서, 팀 내 능력자분들께서 원문을 [한글로 깔끔하게 번역 & 정리](http://jongwook.github.io/google-styleguide/trunk/cppguide.xml)해 주셨습니다. 
[구글에서 검색해보니](https://www.google.co.kr/search?q=google+c%2B%2B+style+guide+%EB%B2%88%EC%97%AD&oq=gooel+c%2B%2B+st&aqs=chrome.2.69i57j0l5.5908j0j4&sourceid=chrome&es_sm=93&ie=UTF-8) 오래전에 번역되다가 말았던 문서들은 몇 개 보이는데 이번에 팀 내에서 번역한 문서는 아직 공유가 널리 안 된 것 같아서 다시 한 번 소개도 할 겸 포스팅 합니다. - 이 글의 목적입니다.

일단 간단한 샘플을 한 번 볼까요? (제가 구글 컨벤션을 100% 체득(?)한 상황은 아니지만, 대략적으로 분위기만 한 번 둘러보죠.)

```cpp
class Test {
 public:
  Test();
  virtual ~Test();

  int some_value() const;
  void set_some_value(const int val) {
    some_value_ = val;      // 간단한 예제이니 inline으로 짜봅니다.
  }

 private:
  int some_value_;
};
```
구글 컨벤션의 아주 일부 규칙들이 몇 개 적용된 클래스 선언입니다. 

 * opening brace을 아랫줄로 내리지 않고 바로 붙여쓰는 것이나, 
 * 들여쓰기는 스페이스 2칸.
 * 클래스의 멤버변수는 c스타일처럼 `_`로 연결된 소문자 단어를 사용하고 `_`를 끝에 붙인다는 점
 * getter는 멤버 변수의 이름과 같게, 
 * setter는 `set_변수명()`의 규칙을 지닌다. 
 * 클래스 접근 권한 지정자(public, private)는 스페이스 1칸 들여쓰기.

...정도가 보이네요. (변수명 선언 방식이 헝가리안 표기가 아니예요!)

구글 컨벤션을 따르는 코드의 예제는 breakpad, protobuf같은 구글의 오픈소스 프로젝트에서 볼 수 있습니다. 구글 코드 이외에도 몇몇 오픈소스들을 보면 구글 컨벤션의 영향을 받은듯한 코드들이 제법 보입니다. 얼마전에 잠시 가지고 놀았던 [msgpack](https://github.com/msgpack/msgpack-c)도 어느정도 구글 컨벤션의 영향을 받은 듯한 모양새를 가지고 있더군요. 

구글 컨벤션은 위의 예제에서 보이는 단순한 들여쓰기, 줄바꿈 같은 형식 이야기 말고도 디자인 철학과 관련된 규약들이 많이 있어서, 평소 생각하지 못했던 여러가지 이슈들을 상기시켜줍니다. 문서 내용을 읽는 것만 해도 자신의 코딩 스타일에 대해 많은 점검(?)을 할 수 있어요.

개인적으로는 팀에서 정해진 룰 때문에 먼저 좀 겪어보게 되었는데 나쁘지 않더군요. 아직까지 마음에 안 드는 조항들도 몇 가지 있지만, 앞으로는 팀 코드가 아닌 개인 작업을 할 때에도 구글 컨벤션을 지켜 코딩해볼 생각입니다. 

## 다시 한 번 링크 : 

 * 원문 : http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml
 * 번역문 : http://jongwook.github.io/google-styleguide/trunk/cppguide.xml

## 본격 컨벤션 적용을 위한 팁 :

### vs2013의 서식 설정 옵션 활용

visual studio를 이용해 윈도우에서 개발하는 환경일 경우, IDE로 vs2013을 사용하면 많은 도움이 됩니다. 빌드는 예전 버전으로 하더라도 IDE만 vs2013을 사용할 수 있습니다. 2013에는 IDE의 자동 formatting 방식을 직접 설정할 수 있어요.

{% img center /images/140719_00.png %}

게다가 vs2013 Update 2를 설치하면 설정 가능한 옵션이 좀 더 늘어납니다! Update 3는 아직 안나왔지만 나오면 설정이 더 늘어날지도!!

### 포맷팅을 자동으로 고쳐주는 AStyle 활용

[AStyle](http://astyle.sourceforge.net/)이란 멋진 프로그램이 있어요. 포맷팅을 자동으로 고쳐주는 프로그램인데, 오픈소스로 되어있어 직접 수정 & 활용할 수 있습니다. 이걸 perforce 클라이언트인 p4v.exe pending changelist 창에서 일괄 적용하게 설정할 수도 있고, vs 플러그인으로 만들어서 코딩 중에도 실행해 볼 수 있어요. 포맷팅을 알아서 고쳐주니까 코딩중에는 들여쓰기가 어떻고 빈 칸이 어떤지 일일이 신경 쓸 필요 없으니 아주 편리합니다 -_-)b 강추예요.

